<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="reservation">
	
	<!-- 예약 리스트 조회 -->
	<select id = "selectRsvnList" resultType="java.util.HashMap">
	
		select rsvnnum, memberid, membername, memberphone, 
			RESERVATION2.designname designname, SHOPDESIGN2.designname optionname,
			RESERVATION2.designprice + SHOPDESIGN2.designprice designprice, 
			 bookingdate, rsvndate, RESERVATION2.shopnum

		from
			(select rsvnnum, memberid, membername, shopdesign.designname designname, optionnum,
					 shopdesign.designprice designprice, 
					bookingdate, rsvndate, memberphone, RESERVATION.shopnum shopnum
			
			 from
					(select rsvnnum, memberid, membername, designid, designid2 optionnum, 
							bookingdate, rsvndate, memberphone, shopnum
	 	 			from reservation  inner join memberList 
	 				 using(memberid)
	 				 ) RESERVATION,  SHOPDESIGN
			where RESERVATION.designid = shopdesign.designid
			and RESERVATION.shopnum = #{shopnum}
			) reservation2 left outer join SHOPDESIGN SHOPDESIGN2
		ON reservation2.optionnum = SHOPDESIGN2.designid
		order by rsvnnum;
	
	
	
	</select>
	
	
	
	
</mapper>
